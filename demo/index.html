<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Alpheios Embedded Developer Test Page</title>
    <link rel="stylesheet" href="../dist/style/style.css"/>
    <link rel="stylesheet" href="../dist/style/style-embedded.min.css"/>
    <script src="https://cdn.auth0.com/js/lock/11.14.0/lock.js"></script>
    <script src="../dist/auth0/env-embed.js"></script>
    <style>
      .customenabled {
        color: green;
      }
      .customdisabled {
        color: red;
      }
      .alpheios-info-cont {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        z-index: 1000000;
      }

      .alpheios-info-cont-row {
        width: 100%;
        display: flex;
      }

      .alpheios-info-btn {
        display: inline-block;
        cursor: pointer;
        border: 1px solid lightgrey;
        flex: 1 1 auto;
        text-align: center;
        padding: 5px;
      }
      .alpheios-platform-data-btn {
        width: 100%;
        background: lightblue;
      }
      .alpheios-zoom-in-btn {
        background: lightcoral;
      }
      .alpheios-zoom-out-btn {
        background: lightgreen;
      }
      .alpheios-zoom-reset-btn {
        background: lightseagreen;
      }
      .alpheios-orientation-portrait-btn {
        background: lightsalmon;
      }
      .alpheios-orientation-landscape-btn {
        background: lightskyblue;
      }
      .alpheios-orientation-reset-btn {
        background: lightpink;
      }
    </style>
</head>

<body>
    <script src="../dist/alpheios-embedded.js"></script>
    <script type="text/javascript">
        let cb = function(evt) {
          evt.stopPropagation()
          return true
        }

        document.addEventListener("DOMContentLoaded", function(event) {
          const embedded = new Alpheios.Embedded(
            {
               clientId: 'alpheios-dev',
              //triggerEvents: "dblclick",
              //triggerPreCallback: cb,
              disabledSelector:".customignore",
              enabledClass: 'customenabled',
              disabledClass: 'customdisabled',
              popupInitialPos: {
                left: '150px',
                top: '150px'
              },
              toolbarInitialPos: {
                top: '5vh',
                right: '5vw'
              },
              disableTextSelection: true
            });
          embedded.activate();

          let zoom = function (zoomLevel) {
            let viewportMeta = document.querySelector("meta[name=viewport]");
            if (!viewportMeta) {
              console.info('creating a viewport meta')
              let metaTag=document.createElement('meta');
              metaTag.name = "viewport"
              document.querySelector('head').appendChild(metaTag);
              viewportMeta = document.querySelector("meta[name=viewport]");
            }
            viewportMeta.setAttribute('content', `width=device-width, initial-scale=${zoomLevel}, user-scalable=1`)
          }

          const fullscreen = {
            enter: function (elem){
              if (elem.requestFullscreen) {
                elem.requestFullscreen();
              } else if (elem.msRequestFullscreen) {
                elem.msRequestFullscreen();
              } else if (elem.mozRequestFullScreen) {
                elem.mozRequestFullScreen();
              } else if (elem.webkitRequestFullscreen) {
                elem.webkitRequestFullscreen();
              }
            },
            exit: function () {
              if (document.exitFullscreen) {
                document.exitFullscreen();
              } else if (document.msExitFullscreen) {
                document.msExitFullscreen();
              } else if (document.mozCancelFullScreen) {
                document.mozCancelFullScreen();
              } else if (document.webkitExitFullscreen) {
                document.webkitExitFullscreen();
              }
            }
          };

          const changeOrientation = function (orientation) {
            if(orientation !== 'unlocked') {
              window.screen.orientation.lock(orientation);
            } else {
              window.screen.orientation.unlock();
            }
          };

          const orientationSupported = function () {
            return (window.screen && window.screen.orientation)
          }

          const updatePlatformInfo = function () {
            embedded.ui.platform.getData();
            const info = `TP:${embedded.ui.platform.deviceType} OR:${embedded.ui.platform.orientation} R:${window.screen.width}x${window.screen.height} DPR:${embedded.ui.platform.dpr}`
            document.querySelector('#alpheios-platform-data-btn').textContent = info
          }

          updatePlatformInfo();

          document.querySelector('#alpheios-platform-data-btn').addEventListener('click', function () {
            updatePlatformInfo();
          })
          document.querySelector('#alpheios-zoom-in-btn').addEventListener('click', function () {
            zoom(3);
            updatePlatformInfo();
          })
          document.querySelector('#alpheios-zoom-out-btn').addEventListener('click', function () {
            zoom(0.25);
            updatePlatformInfo();
          })
          document.querySelector('#alpheios-zoom-rest-btn').addEventListener('click', function () {
            zoom(1);
            updatePlatformInfo();
          })
          document.querySelector('#alpheios-orientation-portrait-btn').addEventListener('click', function () {
            if (orientationSupported()) {
              fullscreen.enter(document.documentElement)
              changeOrientation("portrait")
              updatePlatformInfo();
            } else {
              document.querySelector('#alpheios-orientation-portrait-btn').textContent = "N/A"
            }
          })
          document.querySelector('#alpheios-orientation-landscape-btn').addEventListener('click', function () {
            if (orientationSupported()) {
              fullscreen.enter(document.documentElement);
              changeOrientation("landscape");
              updatePlatformInfo();
            } else {
              document.querySelector('#alpheios-orientation-landscape-btn').textContent = "N/A"
            }
          })
          document.querySelector('#alpheios-orientation-reset-btn').addEventListener('click', function () {
            if (orientationSupported()) {
              fullscreen.exit(document.documentElement)
              changeOrientation("unlocked");
              updatePlatformInfo();
            } else {
              document.querySelector('#alpheios-orientation-reset-btn').textContent = "N/A"
            }
          })

          window.addEventListener('orientationchange', function () {
            console.info('orientationchange')
            updatePlatformInfo();
          })

          window.addEventListener("resize", function () {
            console.info('resize')
            const info = `SCR:${window.screen.width}x${window.screen.height} INNR:${window.innerWidth}x${window.innerHeight} OTR:${window.outerWidth}x${window.outerHeight}`
            document.querySelector('#alpheios-platform-data-btn').textContent = info

            // updatePlatformInfo();
            // Get screen size (inner/outerWidth, inner/outerHeight)

          }, false);
        });
    </script>
    <div class="alpheios-info-cont">
      <div class="alpheios-info-cont-row">
        <div id="alpheios-platform-data-btn" class="alpheios-info-btn alpheios-platform-data-btn">Platform Data</div>
      </div>
      <div class="alpheios-info-cont-row">
        <div id="alpheios-orientation-portrait-btn" class="alpheios-info-btn alpheios-orientation-portrait-btn">Portrait</div>
        <div id="alpheios-orientation-landscape-btn" class="alpheios-info-btn alpheios-orientation-landscape-btn">Landscape</div>
        <div id="alpheios-orientation-reset-btn" class="alpheios-info-btn alpheios-orientation-reset-btn">Reset Orientation</div>
      </div>
      <div class="alpheios-info-cont-row">
        <div id="alpheios-zoom-in-btn" class="alpheios-info-btn alpheios-zoom-in-btn">Zoom in</div>
        <div id="alpheios-zoom-out-btn" class="alpheios-info-btn alpheios-zoom-out-btn">Zoom out</div>
        <div id="alpheios-zoom-rest-btn" class="alpheios-info-btn alpheios-zoom-reset-btn">Zoom reset</div>
      </div>


    </div>

    <h4>Greek</h4>
    <div class="alpheios-enabled" id="block1" xml:lang="grc">
      <p>τά ταῖν ταῖν τοῦ</p>
      <p>εγώ εμένα ἐμαυτοῦ ταύταις</p>
      <p>ένα δύο τρία</p>
      <p>όμορφος νέος γλυκός</p>
      <p>συνεχής πλατύς οξύς</p>
      <p>ἄνδρα μοι ἔννεπε, μοῦσα, πολύτροπον</p>
      <p>πρόσφυμα ξηρή </p>
      <p>σκληρή ζώνη ινώδους συνδετικού ιστού που συνδέει συνήθως μύες με οστά</p>
    </div>

    <h4>Latin</h4>
    <div class="alpheios-enabled" id="block2" lang="lat">
      <p>fero ferre tuli latus ferant missing-word</p>
      <p>sum sunt</p>
      <p>mare cupidinibus cepit differ</p>
      <p>a bene placito</p>
      <p>ab ovo usque ad mala</p>
      <p>caeli  beatum</p>
      <p class="customignore">Ignore This</p>
    </div>

    <h4>Arabic</h4>
    <div class="alpheios-enabled" id="block3" lang="ara" dir="rtl">
       1 اَلدٌّنيَا دَارُ مَمَرٍ لاَ دَارُ مَقَرٍ * سُلطَان بِلاَ عَدلٍ كَنَهرٍ
    </div>

    <h4>Persian</h4>
    <div class="alpheios-enabled" id="block4" lang="per" dir="rtl">
                آبادائیدن
                به نام خداوند جان و خرد
                کزین برتر اندیشه برنگذرد
                خداوند نام و خداوند جای
                خداوند روزی ده رهنمای
                خداوند کیوان و گردان سپهر
                فروزنده ماه و ناهید و مهر
                ز نام و نشان و گمان برترست
                نگارندهٔ بر شده پیکرست
                به بینندگان آفریننده را
                نبینی مرنجان دو بیننده را
                نیابد بدو نیز اندیشه راه
                که او برتر از نام و از جایگاه
                سخن هر چه زین گوهران بگذرد
                نیابد بدو راه جان و خرد
    </div>

    <h4>Ge'ez</h4>
    <div class="alpheios-enabled" id="block5" lang="gez" dir="ltr">
      ይትባረክ፡ እግዚአብሔር፡ አምላከ፡ እስራኤል፡ አምላክ፡ ለኵሉ፡ መንፈስ፡ ወለኵሉ፡ ዘሥጋ፡ ወይቤሎ፡ እግዚአብሔር፡ ለእዝራ፡ አእምር፡ ወጠይቅ፡
    </div>

</div>

</body>
</html>
